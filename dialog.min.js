!function(){"use strict";function e(e,n){for(;e[0].parentNode;)if(e=e.parent(),e.hasClass(n))return e;return null}angular.module("ezdialog",["ngAnimate"]).factory("ezmodal",["$compile","$rootScope","$document","$timeout","$q",function(e,n,o,t,a){function i(e){var n=a.defer(),o={close:function(o){l.remove(e),n.resolve(o)},result:n.promise};e.callback||(e.callback={}),e.instance=o}var l,r=e("<ezdialog-modal/>")(n),s={};return o.find("body").append(r),t(function(){l=r.controller("ezdialogModal")}),o.on("keydown",function(e){var o;if(l&&(o=l.top())&&!e.ctrlKey&&!e.altKey&&(27!=e.keyCode||e.shiftKey||(n.$apply(function(){o.instance.close()}),e.preventDefault()),13!=e.keyCode||o.fake||e.shiftKey||(n.$apply(function(){l.ok(o)}),e.preventDefault()),9==e.keyCode)){var t,a,i,r=o.element[0].querySelectorAll("input, select, button, textarea, a, [tabindex]");for(i=0;i<r.length;i++)if(r[i]==document.activeElement){a=e.shiftKey?(i-1+r.length)%r.length:(i+1)%r.length,r[a].focus(),t=!0;break}!t&&r.length&&r[0].focus(),e.preventDefault()}}),{open:function(e){return i(e),l.add(e),e.instance},register:function(e){s[e.id]=e},toggle:function(e){var n;angular.isString(e)?n=s[e]:angular.isObject(e)&&(n=e),i(n),n.isOpened?l.remove(n):l.add(n)}}}]).directive("ezdialogModal",["$animate","$timeout",function(e,n){return{restrict:"E",template:'<div class="modal-backdrop in" ng-style="{\'z-index\': getBackdropZ()}" ng-if="dialogs.length" ng-destroy="backdropCleanup()"></div>				<div class="modal modal-{{dialog.type}}" ng-repeat="dialog in dialogs | filter:isDialog" ng-style="{\'z-index\': dialog.zIndex}"><!--					--><div class="modal-dialog modal-{{dialog.size}}" tabindex="-1" role="dialog">						<div class="modal-content">							<form role="form" name="form">								<div class="modal-header">									<h3 class="modal-title">{{dialog.title}}</h3>								</div>								<div class="modal-body ezdialog-body"></div>								<div class="modal-footer">									<button class="btn btn-{{dialog.type}}" ng-click="ok(dialog)" type="submit" ng-if="dialog.yes!==undefined" ng-disabled="form.$invalid">{{dialog.yes}}</button>									<button class="btn btn-default" ng-click="cancel(dialog)" type="button" ng-if="dialog.no!==undefined">{{dialog.no}}</button>								</div>							</form>						</div>					</div>				</div>',scope:{},controller:["$scope","$document",function(o,t){o.dialogs=[],o.getBackdropZ=function(){var e=o.dialogs.length-1;return e>=0?o.dialogs[e]-1:1399},o.isDialog=function(e){return!e.fake},o.backdropCleanup=function(){t.find("body").removeClass("modal-open").css("padding-right","")},this.ok=o.ok=function(e){e.callback.ok?e.callback.ok.call(e.instance):e.instance.close(!0)},this.cancel=o.cancel=function(e){e.callback.cancel?e.callback.cancel.call(e.instance):e.instance.close(!1)},this.add=function(a){var i=t.find("body");if(!o.dialogs.length&&!i.hasClass("modal-open")){var l=window.innerWidth-document.body.clientWidth;i.addClass("modal-open").css("padding-right",l+"px")}var r=o.dialogs.length-1;a.zIndex=r>=0?o.dialogs[r].zIndex+10:1400,a.isOpened=!0,a.fake&&(a.element.css("z-index",a.zIndex),e.addClass(a.element,"show")),o.dialogs.push(a),n(function(){var e=a.element[0].querySelector(".modal-dialog");e.style.outline="none";var n,o=e.querySelectorAll("input, textarea, button");for(n=0;n<o.length;n++)if(o[n].autofocus)return void o[n].focus();e.focus()})},this.remove=function(n){var t=o.dialogs.indexOf(n);0>t||(n.isOpened=!1,n.fake&&e.removeClass(n.element,"show"),o.dialogs.splice(t,1))},this.top=function(){var e=o.dialogs.length-1;return 0>e?null:o.dialogs[e]}}]}}]).directive("ezdialogBody",function(){return{restrict:"C",scope:!0,template:'				<span style="white-space: pre-wrap;" ng-if="!dialog.template && !dialog.loaded">{{dialog.msg}}</span>				<span style="white-space: pre-wrap;" ng-if="dialog.template && !dialog.loaded">{{dialog.error || dialog.msg}}</span>				<ng-include src="dialog.template" onload="dialog.loaded=true" ng-if="dialog.template" />',link:function(n,o){var t,a,i=n.dialog;for(i.element||(i.element=e(o,"modal")),i.scope.param||(i.scope.param=i.param),a=Object.keys(i.scope),t=0;t<a.length;t++)n[a[t]]=i.scope[a[t]]}}}).factory("ezdialog",["ezmodal",function(e){function n(n){function o(e){return r=e,this}function t(e){return d.ok=e,this}function a(e){return d.cancel=e,this}function i(e){return angular.extend(d,e),this}var l,r=null,d={};return n.size=n.size||s.size,n.callback=d,n.scope=n.scope||{},l=e.open(n),l.result.then(function(e){r&&r(e)}),{close:o,ok:t,cencel:a,callback:i,instance:l}}function o(e,o){var t={title:o||s.title.error,msg:e||s.msg.error,yes:s.btn.ok,type:"danger"};return"object"==typeof e&&(t.msg=s.msg.error,angular.extend(t,e)),n(t)}function t(e,o){var t={title:o||s.title.confirm,msg:e||s.msg.confirm,yes:s.btn.ok,no:s.btn.cancel,type:"primary"};return"object"==typeof e&&(t.msg=s.msg.confirm,angular.extend(t,e)),n(t)}function a(e,o){var t={title:o||s.title.yesno,msg:e||s.msg.yesno,yes:s.btn.yes,no:s.btn.no,type:"primary"};return"object"==typeof e&&(t.msg=s.msg.yesno,angular.extend(t,e)),n(t)}function i(e,o){var t={title:o||s.title.show,msg:e||s.msg.show,yes:s.btn.ok,type:"primary"};return"object"==typeof e&&(t.msg=s.msg.show,angular.extend(t,e)),n(t)}function l(e){return n(e)}function r(e){return angular.extend(s,e),this}var s={btn:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"},title:{show:"Info",confirm:"Confirm",yesno:"Confirm",error:"Error"},msg:{show:"Hi!",confirm:"Are you sure?",yesno:"Yes or no?",error:"An error occurred!"},size:"sm",backdrop:"static"};return{error:o,confirm:t,yesno:a,show:i,create:l,conf:r}}]).directive("ngDestroy",function(){return{restrict:"A",scope:{ngDestroy:"&"},link:function(e,n){n.on("$destroy",function(){e.ngDestroy()})}}}).directive("ezmodal",["ezmodal",function(e){return{restrict:"E",transclude:!0,template:'<div class="modal-dialog" tabindex="-1" role="dialog">					<div class="modal-content" ng-transclude></div>				</div>',scope:{id:"@",size:"@",backdropToggle:"@"},link:function(n,o,t){var a={fake:!0,size:t.size,id:t.id,element:o};o.addClass("modal"),t.size&&angular.element(o[0].querySelector(".modal-dialog")).addClass("modal-"+t.size),void 0!==t.backdropToggle&&o.on("click",function(o){o.target==this&&n.$apply(function(){e.toggle(a)})}),e.register(a)}}}]).directive("ezmodalToggle",["ezmodal",function(e){return{restrict:"A",link:function(n,o,t){o.on("click",function(){n.$apply(function(){var n=t.ezmodalToggle;e.toggle(n)})})}}}])}();
//# sourceMappingURL=dialog.min.js.map