!function(){"use strict";function a(a,b){for(;a[0].parentNode;)if(a=a.parent(),a.hasClass(b))return a;return null}angular.module("ezdialog",["ngAnimate"]).factory("ezmodal",["$compile","$rootScope","$document","$timeout","$q",function(a,b,c,d,e){function f(a){var b=e.defer(),c={close:function(c){g.remove(a),b.resolve(c)},result:b.promise};a.callback||(a.callback={}),a.instance=c}var g,h=a("<ezdialog-modal/>")(b),i={};return c.find("body").append(h),d(function(){g=h.controller("ezdialogModal")}),c.on("keydown",function(a){var c,d,e,f,h;if(g&&(c=g.top())&&!a.ctrlKey&&!a.altKey&&(27!=a.keyCode||a.shiftKey||(b.$apply(function(){c.instance.close()}),a.preventDefault()),13!=a.keyCode||c.fake||a.shiftKey||(b.$apply(function(){g.ok(c)}),a.preventDefault()),9==a.keyCode)){for(d=c.element[0].querySelectorAll("input, select, button, textarea, a, [tabindex]"),h=0;h<d.length;h++)if(d[h]==document.activeElement){f=a.shiftKey?(h-1+d.length)%d.length:(h+1)%d.length,d[f].focus(),e=!0;break}!e&&d.length&&d[0].focus(),a.preventDefault()}}),{open:function(a){return f(a),g.add(a),a.instance},register:function(a){i[a.id]=a},toggle:function(a){var b;angular.isString(a)?b=i[a]:angular.isObject(a)&&(b=a),f(b),b.isOpened?g.remove(b):g.add(b)}}}]).directive("ezdialogModal",["$animate","$timeout",function(a,b){return{restrict:"E",template:'<div class="modal-backdrop in" ng-style="{\'z-index\': getBackdropZ()}" ng-if="dialogs.length" ng-destroy="backdropCleanup()"></div>				<div class="modal modal-{{dialog.type}}" ng-repeat="dialog in dialogs | filter:isDialog" ng-style="{\'z-index\': dialog.zIndex}"><!--					--><div class="modal-dialog modal-{{dialog.size}}" tabindex="-1" role="dialog">						<div class="modal-content">							<form role="form" name="form">								<div class="modal-header">									<h3 class="modal-title">{{dialog.title}}</h3>								</div>								<div class="modal-body ezdialog-body"></div>								<div class="modal-footer">									<button class="btn btn-{{dialog.type}}" ng-click="ok(dialog)" type="submit" ng-if="dialog.yes!==undefined" ng-disabled="form.$invalid">{{dialog.yes}}</button>									<button class="btn btn-default" ng-click="cancel(dialog)" type="button" ng-if="dialog.no!==undefined">{{dialog.no}}</button>								</div>							</form>						</div>					</div>				</div>',scope:{},controller:["$scope","$document",function(c,d){c.dialogs=[],c.getBackdropZ=function(){var a=c.dialogs.length-1;return a>=0?c.dialogs[a].zIndex-1:1399},c.isDialog=function(a){return!a.fake},c.backdropCleanup=function(){d.find("body").removeClass("modal-open").css("padding-right","")},this.ok=c.ok=function(a){a.callback.ok?a.callback.ok.call(a.instance):a.instance.close(!0)},this.cancel=c.cancel=function(a){a.callback.cancel?a.callback.cancel.call(a.instance):a.instance.close(!1)},this.add=function(e){var f,g=d.find("body");c.dialogs.length||g.hasClass("modal-open")||(f=window.innerWidth-document.body.clientWidth,g.addClass("modal-open").css("padding-right",f+"px"));var h=c.dialogs.length-1;e.zIndex=h>=0?c.dialogs[h].zIndex+10:1400,e.isOpened=!0,e.fake&&(e.element.css("z-index",e.zIndex),a.addClass(e.element,"show")),c.dialogs.push(e),b(function(){var a=e.element[0].querySelector(".modal-dialog");a.style.outline="none";var b,c=a.querySelectorAll("input, textarea, button");for(b=0;b<c.length;b++)if(c[b].autofocus)return void c[b].focus();a.focus()})},this.remove=function(b){var d=c.dialogs.indexOf(b);0>d||(b.isOpened=!1,b.fake&&a.removeClass(b.element,"show"),c.dialogs.splice(d,1))},this.top=function(){var a=c.dialogs.length-1;return 0>a?null:c.dialogs[a]}}]}}]).directive("ezdialogBody",function(){return{restrict:"C",scope:!0,template:'				<span style="white-space: pre-wrap;" ng-if="!dialog.template && !dialog.loaded">{{dialog.msg}}</span>				<span style="white-space: pre-wrap;" ng-if="dialog.template && !dialog.loaded">{{dialog.error || dialog.msg}}</span>				<ng-include src="dialog.template" onload="dialog.loaded=true" ng-if="dialog.template" />',link:function(b,c){var d,e,f=b.dialog;for(f.element||(f.element=a(c,"modal")),f.scope.param||(f.scope.param=f.param),e=Object.keys(f.scope),d=0;d<e.length;d++)b[e[d]]=f.scope[e[d]]}}}).factory("ezdialog",["ezmodal",function(a){function b(b){function c(a){return h=a,this}function d(a){return j.ok=a,this}function e(a){return j.cancel=a,this}function f(a){return angular.extend(j,a),this}var g,h=null,j={};return b.size=b.size||i.size,b.callback=j,b.scope=b.scope||{},g=a.open(b),g.result.then(function(a){h&&h(a)}),{close:c,ok:d,cencel:e,callback:f,instance:g}}function c(a,c){var d={title:c||i.title.error,msg:a||i.msg.error,yes:i.btn.ok,type:"danger"};return"object"==typeof a&&(d.msg=i.msg.error,angular.extend(d,a)),b(d)}function d(a,c){var d={title:c||i.title.confirm,msg:a||i.msg.confirm,yes:i.btn.ok,no:i.btn.cancel,type:"primary"};return"object"==typeof a&&(d.msg=i.msg.confirm,angular.extend(d,a)),b(d)}function e(a,c){var d={title:c||i.title.yesno,msg:a||i.msg.yesno,yes:i.btn.yes,no:i.btn.no,type:"primary"};return"object"==typeof a&&(d.msg=i.msg.yesno,angular.extend(d,a)),b(d)}function f(a,c){var d={title:c||i.title.show,msg:a||i.msg.show,yes:i.btn.ok,type:"primary"};return"object"==typeof a&&(d.msg=i.msg.show,angular.extend(d,a)),b(d)}function g(a){return b(a)}function h(a){return angular.extend(i,a),this}var i={btn:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"},title:{show:"Info",confirm:"Confirm",yesno:"Confirm",error:"Error"},msg:{show:"Hi!",confirm:"Are you sure?",yesno:"Yes or no?",error:"An error occurred!"},size:"sm",backdrop:"static"};return{error:c,confirm:d,yesno:e,show:f,create:g,conf:h}}]).directive("ngDestroy",function(){return{restrict:"A",scope:{ngDestroy:"&"},link:function(a,b){b.on("$destroy",function(){a.ngDestroy()})}}}).directive("ezmodal",["ezmodal",function(a){return{restrict:"E",transclude:!0,template:'<div class="modal-dialog" tabindex="-1" role="dialog">					<div class="modal-content" ng-transclude></div>				</div>',scope:{id:"@",size:"@",backdropToggle:"@"},link:function(b,c,d){var e={fake:!0,size:d.size,id:d.id,element:c};c.addClass("modal"),d.size&&angular.element(c[0].querySelector(".modal-dialog")).addClass("modal-"+d.size),void 0!==d.backdropToggle&&c.on("click",function(c){c.target==this&&b.$apply(function(){a.toggle(e)})}),a.register(e)}}}]).directive("ezmodalToggle",["ezmodal",function(a){return{restrict:"A",link:function(b,c,d){c.on("click",function(){b.$apply(function(){var b=d.ezmodalToggle;a.toggle(b)})})}}}])}();
//# sourceMappingURL=dialog.min.js.map