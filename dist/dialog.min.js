!function(){"use strict";angular.module("ezdialog",["ngAnimate"]).directive("ezdialogStack",["$animate","$timeout","ezdialog",function(a,b,c){return{restrict:"A",templateUrl:"templates/ezdialogStack.html",scope:{},controller:["$scope","$document",function(d,e){d.dialogs=[],d.default=c.conf,d.backdropToggle=function(a){a.toggleBackdrop&&a.close()},d.getBackdropZ=function(){var a=d.dialogs.length-1;return a>=0?d.dialogs[a].zIndex-1:1399},d.backdropCleanup=function(){e.find("body").removeClass("modal-open").css("padding-right","")},this.add=function(c){var f,g=e.find("body");d.dialogs.length||g.hasClass("modal-open")||(f=window.innerWidth-document.body.clientWidth,g.addClass("modal-open").css("padding-right",f+"px"));var h=d.dialogs.length-1;c.zIndex=h>=0?d.dialogs[h].zIndex+10:1400,c.isOpened=!0,c.isDialog||(c.element.css("z-index",c.zIndex),a.addClass(c.element,"show")),d.dialogs.push(c),b(function(){var a=c.element[0].querySelector(".modal-dialog");a.style.outline="none";var b,d=a.querySelectorAll("input, textarea, button");for(b=0;b<d.length;b++)if(d[b].autofocus)return void d[b].focus();a.focus()})},this.remove=function(b){var c=d.dialogs.indexOf(b);0>c||(b.isOpened=!1,b.isDialog||a.removeClass(b.element,"show"),d.dialogs.splice(c,1))},this.top=function(){var a=d.dialogs.length-1;return 0>a?null:d.dialogs[a]},this.open=function(a){a.isDialog=!0,this.add(a)}}]}}]).directive("ezdialogBody",["$templateCache","$compile",function(a,b){return{restrict:"A",scope:{ezdialogBody:"="},link:function(c,d){var e=c.ezdialogBody,f=a.get(e.template);d.html(f),b(d.contents())(e.scope)}}}]).factory("ezdialog",["$rootScope","$compile","$timeout","$document","$q",function(a,b,c,d,e){function f(a,b,c){var d={use:c};return angular.isString(a)?(d.msg=a,d.title=b):angular.isObject(a)&&angular.extend(d,a),l(d),g.open(d),d.deferred.promise}var g,h=b("<div ezdialog-stack />")(a),i={};angular.element(document.body).append(h),c(function(){g=h.controller("ezdialogStack")}),d.on("keydown",function(b){var c,d,e,f,h;if(g&&(c=g.top())&&!b.ctrlKey&&!b.altKey&&(27!=b.keyCode||b.shiftKey||(a.$apply(function(){c.close()}),b.preventDefault()),13!=b.keyCode||c.fake||b.shiftKey||(a.$apply(function(){c.ok()}),b.preventDefault()),9==b.keyCode)){for(d=c.element[0].querySelectorAll("input, select, button, textarea, a, [tabindex]"),h=0;h<d.length;h++)if(d[h]==document.activeElement){f=b.shiftKey?(h-1+d.length)%d.length:(h+1)%d.length,d[f].focus(),e=!0;break}!e&&d.length&&d[0].focus(),b.preventDefault()}});var j={},k=j.conf={btn:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"},title:{show:"Info",confirm:"Confirm",yesno:"Confirm",error:"Error"},msg:{show:"Hi!",confirm:"Are you sure?",yesno:"Yes or no?",error:"An error occurred!"},size:"sm",toggleBackdrop:!1,handleEnter:!0},l=j.init=function(a){switch(a.use){case"show":case"error":a.yes=a.yes||k.btn.ok;break;case"confirm":a.yes=a.yes||k.btn.ok,a.no=a.no||k.btn.cancel;break;case"yesno":a.yes=a.yes||k.btn.yes,a.no=a.no||k.btn.no}a.type="error"==a.use?"danger":a.use?"primary":"default",a.deferred=e.defer();var b=a.deferred.promise;b.ok=function(b){a.onok=b},b.cancel=function(b){a.oncancel=b},b.close=function(b){a.onclose=b},b.instance=a,a.close=function(b){a.onclose?a.onclose(a.realClose):a.realClose(b)},a.ok=function(){a.onok?a.onok(a.realClose):a.realClose(!0)},a.cancel=function(){a.oncancel?a.oncancel(a.realClose):a.realClose(!1)},a.realClose=function(b){g.remove(a),a.deferred.resolve(b)}};return j.error=function(a,b){return f(a,b,"error")},j.confirm=function(a,b){return f(a,b,"confirm")},j.yesno=function(a,b){return f(a,b,"yesno")},j.show=function(a,b){return f(a,b,"show")},j.register=function(a){i[a.id]=a},j.toggle=function(a){var b=i[a];b.isOpened?g.remove(b):g.add(b)},j}]).directive("ngDestroy",function(){return{restrict:"A",scope:{ngDestroy:"&"},link:function(a,b){b.on("$destroy",function(){a.ngDestroy()})}}}).directive("ezdialogToggle",["ezdialog",function(a){return{restrict:"A",link:function(b,c,d){c.on("click",function(){b.$apply(function(){var b=d.ezdialogToggle;a.toggle(b)})})}}}]).directive("ezdialog",["ezdialog",function(a){return{restrict:"A",transclude:!0,templateUrl:"templates/ezdialog.html",scope:{id:"@ezdialog",size:"@",backdropToggle:"@",title:"@",type:"@",use:"@",onclose:"&",oncancel:"&",onok:"&",yes:"@",no:"@"},link:function(b,c){if(!b.id)throw"ezdialog directive requires 'id' attribute";b.default=a.configure,b.element=c,b.backdropToggle=void 0===b.backdropToggle?!1:!0,a.init(b),c.addClass("modal modal-"+b.type),c.on("click",function(a){a.target==this&&b.backdropToggle&&b.$apply(function(){b.close()})}),a.register(b)}}}]).directive("ezdialogBindElement",function(){return{restrict:"A",scope:{dialog:"=ezdialogBindElement"},link:function(a,b){a.dialog.element||(a.dialog.element=b)}}})}(),angular.module("ezdialog").run(["$templateCache",function(a){"use strict";a.put("templates/ezdialog.html",'<div class="modal-dialog" ng-class="\'modal-\' + (size || default.size)" tabindex="-1" role="dialog"><div class="modal-content"><form role="form" name="form"><div class="modal-header"><h3 class="modal-title">{{title || default.title[type]}}</h3></div><div class="modal-body" ng-transclude></div><div class="modal-footer"><button class="btn" ng-class="\'btn-\' + theme" ng-click="ok()" type="submit" ng-if="yes!==undefined" ng-disabled="form.$invalid">{{yes}}</button> <button class="btn btn-default" ng-click="cancel()" type="button" ng-if="no!==undefined">{{no}}</button></div></form></div></div>'),a.put("templates/ezdialogStack.html",'<div class="modal-backdrop in" ng-style="{\'z-index\': getBackdropZ()}" ng-if="dialogs.length" ng-destroy="backdropCleanup()"></div><div class="modal show" ng-class="\'modal-\' + (dialog.type || \'default\')" ng-repeat="dialog in dialogs | filter:{isDialog:true}" ng-style="{\'z-index\': dialog.zIndex}" ng-click="backdropToggle(dialog)" ezdialog-bind-element="dialog"><div class="modal-dialog" ng-class="\'modal-\' + (dialog.size || default.size)" tabindex="-1" role="dialog"><div class="modal-content"><form role="form" name="form"><div class="modal-header"><h3 class="modal-title">{{dialog.title || default.title[dialog.use]}}</h3></div><div class="modal-body"><span style="white-space: pre-wrap" ng-if="!dialog.template && !dialog.loaded">{{dialog.msg}}</span> <span style="white-space: pre-wrap" ng-if="dialog.template && !dialog.loaded">{{dialog.error || dialog.msg}}</span><div ezdialog-body ng-if="dialog.template"></div></div><div class="modal-footer"><button class="btn" ng-class="\'btn-\' + (dialog.type || \'default\')" ng-click="dialog.ok()" ng-if="dialog.yes !== undefined" ng-disabled="form.$invalid">{{dialog.yes}}</button> <button class="btn btn-default" ng-click="dialog.cancel()" type="button" ng-if="dialog.no !== undefined">{{dialog.no}}</button></div></form></div></div></div>')}]);
//# sourceMappingURL=dialog.min.js.map