!function(){"use strict";angular.module("ezdialog",["ngAnimate"]).directive("ezdialogStack",["$animate","$timeout",function(a,b){return{restrict:"A",templateUrl:"templates/ezdialogStack.html",scope:{},controller:["$scope","$document","ezdialog",function(c,d,e){c.dialogs=[],c.default=e.conf,c.backdropToggle=function(a){a.toggleBackdrop&&a.cancel()},c.getBackdropZ=function(){var a=c.dialogs.length-1;return a>=0?c.dialogs[a].zIndex-1:1399},c.backdropCleanup=function(){d.find("body").removeClass("modal-open").css("padding-right","")},this.add=function(e){var f,g=d.find("body");c.dialogs.length||g.hasClass("modal-open")||(f=window.innerWidth-document.body.clientWidth,g.addClass("modal-open").css("padding-right",f+"px"));var h=c.dialogs.length-1;e.zIndex=h>=0?c.dialogs[h].zIndex+10:1400,e.isOpened=!0,e.isDialog||(e.element.css("z-index",e.zIndex),a.addClass(e.element,"show")),c.dialogs.push(e),b(function(){var a=e.element[0].querySelector(".modal-dialog");a.style.outline="none";var b,c=a.querySelectorAll("input, textarea, button");for(b=0;b<c.length;b++)if(c[b].autofocus)return void c[b].focus();a.focus()})},this.remove=function(b){var d=c.dialogs.indexOf(b);0>d||(b.isOpened=!1,b.isDialog||a.removeClass(b.element,"show"),c.dialogs.splice(d,1))},this.top=function(){var a=c.dialogs.length-1;return 0>a?null:c.dialogs[a]},this.open=function(a){a.isDialog=!0,this.add(a)}}]}}]).directive("ezdialogCopyScope",function(){return{restrict:"A",scope:!0,link:function(a){var b,c,d=a.dialog;if(d.scope)for(b=Object.keys(d.scope),c=0;c<b.length;c++)a[b[c]]=d.scope[b[c]]}}}).factory("ezdialog",["$rootScope","$compile","$timeout","$document","$q",function(a,b,c,d,e){function f(a,b,c){var d={use:c};return angular.isString(a)?(d.msg=a,d.title=b):angular.isObject(a)&&angular.extend(d,a),k(d),g.open(d),d.deferred.promise}var g,h=b("<div ezdialog-stack />")(a),i={};angular.element(document.body).append(h),c(function(){g=h.controller("ezdialogStack")}),d.on("keydown",function(b){var c,d,e,f,h;if(g&&(c=g.top())&&!b.ctrlKey&&!b.altKey&&(27!=b.keyCode||b.shiftKey||(a.$apply(function(){c.cancel()}),b.preventDefault()),13!=b.keyCode||c.fake||b.shiftKey||(a.$apply(function(){c.ok()}),b.preventDefault()),9==b.keyCode)){for(d=c.element[0].querySelectorAll("input, select, button, textarea, a, [tabindex]"),h=0;h<d.length;h++)if(d[h]==document.activeElement){f=b.shiftKey?(h-1+d.length)%d.length:(h+1)%d.length,d[f].focus(),e=!0;break}!e&&d.length&&d[0].focus(),b.preventDefault()}});var j={};j.conf={btn:{show:{yes:"OK"},confirm:{yes:"OK",no:"Cancel"},yesno:{yes:"Yes",no:"No"},error:{yes:"OK"}},title:{show:"Info",confirm:"Confirm",yesno:"Question",error:"Error"},msg:{show:"Hi!",confirm:"Are you sure?",yesno:"Yes or no?",error:"An error occurred!"},type:{show:"info",confirm:"primary",yesno:"warning",error:"danger"},size:"sm",toggleBackdrop:!1};var k=j.init=function(a){a.deferred=e.defer();var b=a.deferred.promise;b.ok=function(b){return a.onok=b,this},b.cancel=function(b){return a.oncancel=b,this},b.close=function(b){return a.onclose=b,this},b.instance=a,a.close=function(b){a.onclose&&a.onclose(b)===!1||a.realClose(b)},a.ok=function(){a.onok?a.onok(a.close):a.close(!0)},a.cancel=function(){a.oncancel?a.oncancel(a.close):a.close(!1)},a.realClose=function(b){g.remove(a),a.deferred.resolve(b)}};return j.error=function(a,b){return f(a,b,"error")},j.confirm=function(a,b){return f(a,b,"confirm")},j.yesno=function(a,b){return f(a,b,"yesno")},j.show=function(a,b){return f(a,b,"show")},j.register=function(a){i[a.id]=a},j.toggle=function(a){var b=i[a];b.isOpened?b.cancel():g.add(b)},j}]).directive("ngDestroy",function(){return{restrict:"A",scope:{ngDestroy:"&"},link:function(a,b){b.on("$destroy",function(){a.ngDestroy()})}}}).directive("ezdialogToggle",["ezdialog",function(a){return{restrict:"A",link:function(b,c,d){c.on("click",function(){b.$apply(function(){var b=d.ezdialogToggle;a.toggle(b)})})}}}]).directive("ezdialog",["ezdialog",function(a){return{restrict:"A",transclude:!0,templateUrl:"templates/ezdialog.html",scope:{id:"@ezdialog",size:"@",title:"@ezdialogTitle",type:"@",use:"@",onclose:"&",oncancel:"&",onok:"&",yes:"@",no:"@"},link:function(b,c,d){b.default=a.conf,b.backdropToggle=void 0===d.backdropToggle?!1:!0,b.onok=d.onok?function(a){return function(){a({$dialog:b})}}(b.onok):null,b.oncancel=d.oncancel?function(a){return function(){a({$dialog:b})}}(b.oncancel):null,b.onclose=d.onclose?function(a){return function(c){var d=!1,e={data:c,preventDefault:function(){d=!0}};return a({$event:e,$dialog:b}),d?!1:void 0}}(b.onclose):null,a.init(b),b.element=c,c.addClass("modal modal-"+(b.type||b.default.type[b.use]||"default")),c.on("click",function(a){a.target==this&&b.backdropToggle&&b.$apply(function(){b.cancel()})}),a.register(b)}}}]).directive("ezdialogBindElement",function(){return{restrict:"A",scope:{dialog:"=ezdialogBindElement"},link:function(a,b){a.dialog.element||(a.dialog.element=b)}}})}(),angular.module("ezdialog").run(["$templateCache",function(a){"use strict";a.put("templates/ezdialog.html",'<div class="modal-dialog" ng-class="\'modal-\' + (size || default.size)" tabindex="-1" role="dialog"><div class="modal-content"><form role="form" name="form"><div class="modal-header"><button class="close" ng-click="cancel()">&times; <span class="sr-only">Close dialog</span></button><h4 class="modal-title">{{title || default.title[use]}}</h4></div><div class="modal-body" ng-transclude></div><div class="modal-footer"><button class="btn" ng-class="\'btn-\' + (type || default.type[use])" ng-click="ok()" type="submit" ng-if="yes !== undefined || !!default.btn[use].yes" ng-disabled="form.$invalid">{{yes || default.btn[use].yes}}</button> <button class="btn btn-default" ng-click="cancel()" type="button" ng-if="no !== undefined || !!default.btn[use].no">{{no || default.btn[use].no}}</button></div></form></div></div>'),a.put("templates/ezdialogStack.html",'<div class="modal-backdrop in" ng-style="{\'z-index\': getBackdropZ()}" ng-if="dialogs.length" ng-destroy="backdropCleanup()"></div><div class="modal show" ng-class="\'modal-\' + (dialog.type || default.type[dialog.use] || \'default\')" ng-repeat="dialog in dialogs | filter:{isDialog:true}" ng-style="{\'z-index\': dialog.zIndex}" ng-click="backdropToggle(dialog)" ezdialog-bind-element="dialog"><div class="modal-dialog" ng-class="\'modal-\' + (dialog.size || default.size)" tabindex="-1" role="dialog"><div class="modal-content"><form role="form" name="form"><div class="modal-header"><button class="close" ng-click="dialog.cancel()">&times; <span class="sr-only">Close dialog</span></button><h4 class="modal-title">{{dialog.title || default.title[dialog.use]}}</h4></div><div class="modal-body"><span style="white-space: pre-wrap" ng-if="!dialog.template && !dialog.loaded">{{dialog.msg || default.msg[dialog.use]}}</span> <span style="white-space: pre-wrap" ng-if="dialog.template && !dialog.loaded">{{dialog.error || dialog.msg}}</span><div ezdialog-copy-scope ng-if="dialog.template" ng-include="dialog.template"></div></div><div class="modal-footer"><button class="btn" ng-class="\'btn-\' + (dialog.type || default.type[dialog.use] || \'default\')" ng-click="dialog.ok()" ng-if="dialog.yes !== undefined || !!default.btn[dialog.use].yes" ng-disabled="form.$invalid">{{dialog.yes || default.btn[dialog.use].yes}}</button> <button class="btn btn-default" ng-click="dialog.cancel()" type="button" ng-if="dialog.no !== undefined || !!default.btn[dialog.use].no">{{dialog.no || default.btn[dialog.use].no}}</button></div></form></div></div></div>')}]);
//# sourceMappingURL=dialog.min.js.map